---
parent: "Api_v1_envs"
name: "ApiV1EnvsPostRolePmAllowedRbac"
description: null
authors:
- "FX Bot"
type: "SUITE"
init: []
path: "/api/v1/envs"
endpoint: "/api/v1/envs"
method: "POST"
auth: "ROLE_PM"
headers:
- "Accept: application/json"
- "Content-Type: application/json"
testCases:
- id: 1
  body: "{\n  \"auths\" : [ {\n    \"accessTokenUri\" : \"{{@Random}}\",\n    \"authType\"\
    \ : \"Basic\",\n    \"authorizationScheme\" : \"query\",\n    \"clientAuthenticationScheme\"\
    \ : \"none\",\n    \"clientId\" : \"{{@Random}}\",\n    \"clientSecret\" : \"\
    {{@Random}}\",\n    \"grantType\" : \"client_credentials\",\n    \"header_1\"\
    \ : \"{{@Random}}\",\n    \"header_2\" : \"{{@Random}}\",\n    \"header_3\" :\
    \ \"{{@Random}}\",\n    \"id\" : \"\",\n    \"name\" : \"{{@Random}}\",\n    \"\
    password\" : \"{{@Random}}\",\n    \"preEstablishedRedirectUri\" : \"{{@Random}}\"\
    ,\n    \"scope\" : \"{{@Random}}\",\n    \"tokenName\" : \"{{@Random}}\",\n  \
    \  \"useCurrentUri\" : false,\n    \"userAuthorizationUri\" : \"{{@Random}}\"\
    ,\n    \"username\" : \"{{@Faker.name.username}}\"\n  } ],\n  \"baseUrl\" : \"\
    {{@Random}}\",\n  \"createdBy\" : \"\",\n  \"createdDate\" : \"\",\n  \"description\"\
    \ : \"{{@XSSSQLInjections}}\",\n  \"id\" : \"\",\n  \"inactive\" : false,\n  \"\
    modifiedBy\" : \"\",\n  \"modifiedDate\" : \"\",\n  \"name\" : \"{{@Random}}\"\
    ,\n  \"projectId\" : \"{{@Random}}\",\n  \"refId\" : \"{{@Random}}\",\n  \"version\"\
    \ : \"\"\n}"
  inactive: false
assertions:
- "@StatusCode != 401 AND @StatusCode != 403"
cleanup: []
severity: "Major"
category: "RBAC"
tags:
- "V1"
- "OWASP - OTG-IDENT-001 "
- "FX Top 10 - API Vulnerability"
inactive: false
policies: null
autoGenerated: true
